function hideElement(e,t){if(ie)for(i=0;i<document.all.tags(e).length;i++)if(obj=document.all.tags(e)[i],obj&&obj.offsetParent){for(objLeft=obj.offsetLeft,objTop=obj.offsetTop,objParent=obj.offsetParent;"BODY"!=objParent.tagName.toUpperCase();)objLeft+=objParent.offsetLeft,objTop+=objParent.offsetTop,objParent=objParent.offsetParent;objHeight=obj.offsetHeight,objWidth=obj.offsetWidth,t.offsetLeft+t.offsetWidth<=objLeft||t.offsetTop+t.offsetHeight<=objTop||t.offsetTop>=objTop+objHeight||t.offsetLeft>=objLeft+objWidth||(obj.style.visibility="hidden")}}function showElement(e){if(ie)for(i=0;i<document.all.tags(e).length;i++)obj=document.all.tags(e)[i],obj&&obj.offsetParent&&(obj.style.visibility="")}function HolidayRec(e,t,o,a){this.d=e,this.m=t,this.y=o,this.desc=a}function addHoliday(e,t,o,a){Holidays[HolidaysCounter++]=new HolidayRec(e,t,o,a)}function swapImage(e,t){ie&&document.getElementById(e).setAttribute("src",imgDir+t)}function init(){ns4||(crossobj=dom?document.getElementById("calendar").style:ie?document.all.calendar:document.calendar,hideCalendar(),crossMonthObj=dom?document.getElementById("selectMonth").style:ie?document.all.selectMonth:document.selectMonth,crossYearObj=dom?document.getElementById("selectYear").style:ie?document.all.selectYear:document.selectYear,monthConstructed=!1,yearConstructed=!1,1==showToday&&(document.getElementById("lblToday").innerHTML=todayString+" <a onmousemove='window.status=\""+gotoString+"\"' onmouseout='window.status=\"\"' title='"+gotoString+"' style='"+styleAnchor+"' href='javascript:monthSelected=monthNow;yearSelected=yearNow;constructCalendar();'>"+dayName[today.getDay()-startAt==-1?6:today.getDay()-startAt]+", "+dateNow+" "+monthName[monthNow].substring(0,3)+"\t"+yearNow+"</a>"),sHTML1='<span id=\'spanLeft\'\tstyle=\'border-style:solid;border-width:1;border-color:#3366FF;cursor:pointer\' onmouseover=\'swapImage("changeLeft","left2.gif");this.style.borderColor="#88AAFF";window.status="'+scrollLeftMessage+"\"' onclick='javascript:decMonth()' onmouseout='clearInterval(intervalID1);swapImage(\"changeLeft\",\"left1.gif\");this.style.borderColor=\"#3366FF\";window.status=\"\"' onmousedown='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"StartDecMonth()\",500)'\tonmouseup='clearTimeout(timeoutID1);clearInterval(intervalID1)'>&nbsp<IMG id='changeLeft' SRC='"+imgDir+"left1.gif' width=10 height=11 BORDER=0>&nbsp</span>&nbsp;",sHTML1+='<span id=\'spanRight\' style=\'border-style:solid;border-width:1;border-color:#3366FF;cursor:pointer\'\tonmouseover=\'swapImage("changeRight","right2.gif");this.style.borderColor="#88AAFF";window.status="'+scrollRightMessage+"\"' onmouseout='clearInterval(intervalID1);swapImage(\"changeRight\",\"right1.gif\");this.style.borderColor=\"#3366FF\";window.status=\"\"' onclick='incMonth()' onmousedown='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"StartIncMonth()\",500)'\tonmouseup='clearTimeout(timeoutID1);clearInterval(intervalID1)'>&nbsp<IMG id='changeRight' SRC='"+imgDir+"right1.gif'\twidth=10 height=11 BORDER=0>&nbsp</span>&nbsp",sHTML1+='<span id=\'spanMonth\' style=\'border-style:solid;border-width:1;border-color:#3366FF;cursor:pointer\'\tonmouseover=\'swapImage("changeMonth","drop2.gif");this.style.borderColor="#88AAFF";window.status="'+selectMonthMessage+'"\' onmouseout=\'swapImage("changeMonth","drop1.gif");this.style.borderColor="#3366FF";window.status=""\' onclick=\'popUpMonth()\'></span>&nbsp;',sHTML1+='<span id=\'spanYear\' style=\'border-style:solid;border-width:1;border-color:#3366FF;cursor:pointer\' onmouseover=\'swapImage("changeYear","drop2.gif");this.style.borderColor="#88AAFF";window.status="'+selectYearMessage+'"\'\tonmouseout=\'swapImage("changeYear","drop1.gif");this.style.borderColor="#3366FF";window.status=""\'\tonclick=\'popUpYear()\'></span>&nbsp;',document.getElementById("caption").innerHTML=sHTML1,bPageLoaded=!0)}function hideCalendar(){crossobj.visibility="hidden",null!=crossMonthObj&&(crossMonthObj.visibility="hidden"),null!=crossYearObj&&(crossYearObj.visibility="hidden"),showElement("SELECT"),showElement("APPLET")}function padZero(e){return e<10?"0"+e:e}function constructDate(e,t,o){return sTmp=dateFormat,sTmp=sTmp.replace("dd","<e>"),sTmp=sTmp.replace("d","<d>"),sTmp=sTmp.replace("<e>",padZero(e)),sTmp=sTmp.replace("<d>",e),sTmp=sTmp.replace("mmmm","<p>"),sTmp=sTmp.replace("mmm","<o>"),sTmp=sTmp.replace("mm","<n>"),sTmp=sTmp.replace("m","<m>"),sTmp=sTmp.replace("<m>",t+1),sTmp=sTmp.replace("<n>",padZero(t+1)),sTmp=sTmp.replace("<o>",monthName[t]),sTmp=sTmp.replace("<p>",monthName2[t]),sTmp=sTmp.replace("yyyy",o),sTmp.replace("yy",padZero(o%100))}function closeCalendar1(){hideCalendar(),ctlToPlaceValue.value=constructDate(dateSelected,monthSelected,yearSelected),"fromDate"==ctlToPlaceValue.name&&""!=ctlToPlaceValue.value&&(document.getElementById("sortStart").style.display=""),"toDate"==ctlToPlaceValue.name&&""!=ctlToPlaceValue.value&&(document.getElementById("sortEnd").style.display="")}function StartDecMonth(){intervalID1=setInterval("decMonth()",80)}function StartIncMonth(){intervalID1=setInterval("incMonth()",80)}function incMonth(){++monthSelected>11&&(monthSelected=0,yearSelected++),constructCalendar()}function decMonth(){--monthSelected<0&&(monthSelected=11,yearSelected--),constructCalendar()}function constructMonth(){if(popDownYear(),!monthConstructed){for(sHTML="",i=0;i<12;i++)sName=monthName[i],i==monthSelected&&(sName="<B>"+sName+"</B>"),sHTML+="<tr><td id='m"+i+"' onmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='this.style.backgroundColor=\"\"' style='cursor:pointer' onclick='monthConstructed=false;monthSelected="+i+";constructCalendar();popDownMonth();event.cancelBubble=true'>&nbsp;"+sName+"&nbsp;</td></tr>";document.getElementById("selectMonth").innerHTML="<table width=70\tstyle='font-family:arial; font-size:11px; border-width:1; border-style:solid; border-color:#a0a0a0;' bgcolor='#FFFFDD' cellspacing=0 onmouseover='clearTimeout(timeoutID1)'\tonmouseout='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"popDownMonth()\",100);event.cancelBubble=true'>"+sHTML+"</table>",monthConstructed=!0}}function popUpMonth(){constructMonth(),crossMonthObj.visibility=dom||ie?"visible":"show",crossMonthObj.left=parseInt(crossobj.left)+50,crossMonthObj.top=parseInt(crossobj.top)+26,hideElement("SELECT",document.getElementById("selectMonth")),hideElement("APPLET",document.getElementById("selectMonth"))}function popDownMonth(){crossMonthObj.visibility="hidden"}function incYear(){for(i=0;i<7;i++)newYear=i+nStartingYear+1,newYear==yearSelected?txtYear="&nbsp;<B>"+newYear+"</B>&nbsp;":txtYear="&nbsp;"+newYear+"&nbsp;",document.getElementById("y"+i).innerHTML=txtYear;nStartingYear++,bShow=!0}function decYear(){for(i=0;i<7;i++)newYear=i+nStartingYear-1,newYear==yearSelected?txtYear="&nbsp;<B>"+newYear+"</B>&nbsp;":txtYear="&nbsp;"+newYear+"&nbsp;",document.getElementById("y"+i).innerHTML=txtYear;nStartingYear--,bShow=!0}function selectYear(e){yearSelected=parseInt(e+nStartingYear),yearConstructed=!1,constructCalendar(),popDownYear()}function constructYear(){if(popDownMonth(),sHTML="",!yearConstructed){for(sHTML="<tr><td align='center'\tonmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='clearInterval(intervalID1);this.style.backgroundColor=\"\"' style='cursor:pointer'\tonmousedown='clearInterval(intervalID1);intervalID1=setInterval(\"decYear()\",30)' onmouseup='clearInterval(intervalID1)'>-</td></tr>",j=0,nStartingYear=yearSelected-3,i=yearSelected-3;i<=yearSelected+3;i++)sName=i,i==yearSelected&&(sName="<B>"+sName+"</B>"),sHTML+="<tr><td id='y"+j+"' onmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='this.style.backgroundColor=\"\"' style='cursor:pointer' onclick='selectYear("+j+");event.cancelBubble=true'>&nbsp;"+sName+"&nbsp;</td></tr>",j++;sHTML+="<tr><td align='center' onmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='clearInterval(intervalID2);this.style.backgroundColor=\"\"' style='cursor:pointer' onmousedown='clearInterval(intervalID2);intervalID2=setInterval(\"incYear()\",30)'\tonmouseup='clearInterval(intervalID2)'>+</td></tr>",document.getElementById("selectYear").innerHTML="<table width=44 style='font-family:arial; font-size:11px; border-width:1; border-style:solid; border-color:#a0a0a0;'\tbgcolor='#FFFFDD' onmouseover='clearTimeout(timeoutID2)' onmouseout='clearTimeout(timeoutID2);timeoutID2=setTimeout(\"popDownYear()\",100)' cellspacing=0>"+sHTML+"</table>",yearConstructed=!0}}function popDownYear(){clearInterval(intervalID1),clearTimeout(timeoutID1),clearInterval(intervalID2),clearTimeout(timeoutID2),crossYearObj.visibility="hidden"}function popUpYear(){var e;constructYear(),crossYearObj.visibility=dom||ie?"visible":"show",e=parseInt(crossobj.left)+document.getElementById("spanYear").offsetLeft,ie&&(e+=6),crossYearObj.left=e,crossYearObj.top=parseInt(crossobj.top)+26}function WeekNbr(e){return year=e.getFullYear(),month=e.getMonth()+1,day=0==startAt?e.getDate()+1:e.getDate(),a=Math.floor((14-month)/12),y=year+4800-a,m=month+12*a-3,b=Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400),J=day+Math.floor((153*m+2)/5)+365*y+b-32045,d4=(J+31741-J%7)%146097%36524%1461,L=Math.floor(d4/1460),d1=(d4-L)%365+L,week=Math.floor(d1/7)+1,week}function constructCalendar(){var e,t,o=Array(31,0,31,30,31,30,31,31,30,31,30,31),a=new Date(yearSelected,monthSelected,1);for(1==monthSelected?(t=new Date(yearSelected,monthSelected+1,1),t=new Date(t-864e5),numDaysInMonth=t.getDate()):numDaysInMonth=o[monthSelected],datePointer=0,dayPointer=a.getDay()-startAt,dayPointer<0&&(dayPointer=6),sHTML="<table\t border=0 style='font-family:verdana;font-size:10px;'><tr>",1==showWeekNumber&&(sHTML+="<td width=27><b>"+weekString+"</b></td><td width=1 rowspan=7 bgcolor='#d0d0d0' style='padding:0px'><img src='"+imgDir+"divider.gif' width=1></td>"),r=0;r<7;r++)sHTML+="<td width='27' align='right'><B>"+dayName[r]+"</B></td>";sHTML+="</tr><tr>",1==showWeekNumber&&(sHTML+="<td align=right>"+WeekNbr(a)+"&nbsp;</td>");for(var r=1;r<=dayPointer;r++)sHTML+="<td>&nbsp;</td>";for(datePointer=1;datePointer<=numDaysInMonth;datePointer++){for(dayPointer++,sHTML+="<td align=right>",sStyle=styleAnchor,datePointer==odateSelected&&monthSelected==omonthSelected&&yearSelected==oyearSelected&&(sStyle+=styleLightBorder),sHint="",s=0;s<HolidaysCounter;s++)parseInt(Holidays[s].d)==datePointer&&parseInt(Holidays[s].m)==monthSelected+1&&(0==parseInt(Holidays[s].y)||parseInt(Holidays[s].y)==yearSelected&&0!=parseInt(Holidays[s].y))&&(sStyle+="background-color:#FFDDDD;",sHint+=""==sHint?Holidays[s].desc:"\n"+Holidays[s].desc);var n=/\"/g;sHint=sHint.replace(n,"&quot;");var s=0;e="onmousemove='window.status=\""+selectDateMessage.replace("[date]",constructDate(datePointer,monthSelected,yearSelected))+"\"' onmouseout='window.status=\"\"' ";for(var i=new Array,l=new Date(yearSelected,monthSelected,datePointer),d=0;d<i.length;d++)Date.parse(i[d])==Date.parse(l)&&s++;s>0?sHTML+="&nbsp;<font color=blue>"+datePointer+"</font>&nbsp;":datePointer==dateNow&&monthSelected==monthNow&&yearSelected==yearNow?sHTML+="<b><a "+e+' title="'+sHint+"\" style='"+sStyle+"' href='javascript:dateSelected="+datePointer+";closeCalendar1();'><font color=#ff0000>&nbsp;"+datePointer+"</font>&nbsp;</a></b>":(dayPointer,sHTML+="<a "+e+' title="'+sHint+"\" style='"+sStyle+"' href='javascript:dateSelected="+datePointer+";closeCalendar1();'>&nbsp;"+datePointer+"&nbsp;</a>"),sHTML+="",(dayPointer+startAt)%7==startAt&&(sHTML+="</tr><tr>",1==showWeekNumber&&datePointer<numDaysInMonth&&(sHTML+="<td align=right>"+WeekNbr(new Date(yearSelected,monthSelected,datePointer+1))+"&nbsp;</td>"))}document.getElementById("content").innerHTML=sHTML,document.getElementById("spanMonth").innerHTML="&nbsp;"+monthName[monthSelected]+"&nbsp;<IMG id='changeMonth' SRC='"+imgDir+"drop1.gif' WIDTH='12' HEIGHT='10' BORDER=0>",document.getElementById("spanYear").innerHTML="&nbsp;"+yearSelected+"&nbsp;<IMG id='changeYear' SRC='"+imgDir+"drop1.gif' WIDTH='12' HEIGHT='10' BORDER=0>"}function popUpCalendar(e,t,o){var a=212,r=0;if(bPageLoaded){if("hidden"==crossobj.visibility){if(ctlToPlaceValue=t,dateFormat=o,formatChar=" ",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar="/",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar=".",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar="-",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar="")))),tokensChanged=0,""!=formatChar)for(aData=t.value.split(formatChar),i=0;i<3;i++)if("d"==aFormat[i]||"dd"==aFormat[i])dateSelected=parseInt(aData[i],10),tokensChanged++;else if("m"==aFormat[i]||"mm"==aFormat[i])monthSelected=parseInt(aData[i],10)-1,tokensChanged++;else if("yyyy"==aFormat[i])yearSelected=parseInt(aData[i],10),tokensChanged++;else if("mmm"==aFormat[i])for(j=0;j<12;j++)aData[i]==monthName[j]&&(monthSelected=j,tokensChanged++);else if("mmmm"==aFormat[i])for(j=0;j<12;j++)aData[i]==monthName2[j]&&(monthSelected=j,tokensChanged++);(3!=tokensChanged||isNaN(dateSelected)||isNaN(monthSelected)||isNaN(yearSelected))&&(dateSelected=dateNow,monthSelected=monthNow,yearSelected=yearNow),odateSelected=dateSelected,omonthSelected=monthSelected,oyearSelected=yearSelected,aTag=e;do{aTag=aTag.offsetParent,a+=aTag.offsetLeft,r+=aTag.offsetTop}while("BODY"!=aTag.tagName);crossobj.left=-1==fixedX?e.offsetLeft+"px":fixedX,crossobj.top=-1==fixedY?e.offsetTop+r+e.offsetHeight+2+"px":fixedY,constructCalendar(1,monthSelected,yearSelected),crossobj.visibility=dom||ie?"visible":"show",hideElement("SELECT",document.getElementById("calendar")),hideElement("APPLET",document.getElementById("calendar")),bShow=!0}else hideCalendar(),ctlNow!=e&&popUpCalendar(e,t,o);ctlNow=e}}var fixedX=-1,fixedY=-1,startAt=1,showWeekNumber=1,showToday=1,imgDir=baseUrl+"images/",gotoString="Go To Current Month",todayString="Today is",weekString="Wk",scrollLeftMessage="Click to scroll to previous month. Hold mouse button to scroll automatically.",scrollRightMessage="Click to scroll to next month. Hold mouse button to scroll automatically.",selectMonthMessage="Click to select a month.",selectYearMessage="Click to select a year.",selectDateMessage="Select [date] as date.",crossobj,crossMonthObj,crossYearObj,monthSelected,yearSelected,dateSelected,omonthSelected,oyearSelected,odateSelected,monthConstructed,yearConstructed,intervalID1,intervalID2,timeoutID1,timeoutID2,ctlToPlaceValue,ctlNow,dateFormat,nStartingYear,bPageLoaded=!1,ie=document.all,dom=document.getElementById,ns4=document.layers,today=new Date,dateNow=today.getDate(),monthNow=today.getMonth(),yearNow=today.getFullYear(),imgsrc=new Array("drop1.gif","drop2.gif","left1.gif","left2.gif","right1.gif","right2.gif"),img=new Array,bShow=!1,HolidaysCounter=0,Holidays=new Array;if(dom){for(i=0;i<imgsrc.length;i++)img[i]=new Image,img[i].src=imgDir+imgsrc[i];document.write("<div onclick='bShow=true' id='calendar'\tstyle='z-index:+999;position:absolute;visibility:hidden;'><table\twidth="+(1==showWeekNumber?250:220)+" style='font-family:arial;font-size:11px;border-width:1;border-style:solid;border-color:#a0a0a0;font-family:arial; font-size:11px}' bgcolor='#ffffff'><tr bgcolor='#0000aa'><td><table width='"+(1==showWeekNumber?248:218)+"'><tr><td style='padding:2px;font-family:arial; font-size:11px;'><font color='#ffffff'><B><span id='caption'></span></B></font></td><td align=right><a href='javascript:hideCalendar()'><IMG SRC='"+imgDir+"close.gif' WIDTH='15' HEIGHT='13' BORDER='0' ALT='Close the Calendar'></a></td></tr></table></td></tr><tr><td style='padding:5px' bgcolor=#ffffff><span id='content'></span></td></tr>"),1==showToday&&document.write("<tr bgcolor=#f0f0f0><td style='padding:5px' align=center><span id='lblToday'></span></td></tr>"),document.write("</table></div><div id='selectMonth' style='z-index:+999;position:absolute;visibility:hidden;'></div><div id='selectYear' style='z-index:+999;position:absolute;visibility:hidden;'></div>")}var monthName=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),monthName2=new Array("JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC");dayName=0==startAt?new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"):new Array("Mon","Tue","Wed","Thu","Fri","Sat","Sun");var styleAnchor="text-decoration:none;color:black;",styleLightBorder="border-style:solid;border-width:1px;border-color:#a0a0a0;";document.onkeypress=function(){},document.onclick=function(){bShow||hideCalendar(),bShow=!1},ie?init():window.onload=init;